<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="css/header.css">
</head>
<body>
<div id="wrapper">
    <div id="header">
        <img class="logo" src="img/月亮.png" alt="">
        <h1>红月游戏交易平台</h1>
        <hr>
    </div>
    <div id="content" style="margin-top: 50px">
        用户名：<input type="text" id="uname" onblur="register_uname()"><span id="unameMsg"></span><br><br><br>
        &nbsp;&nbsp;密码：<input type="text" id="upwd">
        <a href="http://127.0.0.1:3000/admin_user.html" onclick="user_add()" style="text-decoration: none;display: block;height: 30px;line-height: 30px;width: 100px;text-align: center;background-color: red;color: #fff;margin-top: 20px;">添加用户</a>
    </div>
</div>
<script>
    // function register_uname(){
    //     isregisterUname=false;
    //     //创建异步对象
    //     var xhr=new XMLHttpRequest;
    //     //绑定监听
    //     xhr.onreadystatechange=function(){
    //         if(xhr.readyState==4&&xhr.status==200){
    //             var result=xhr.responseText;
    //             if(result==1){
    //                 unameMsg.innerHTML='用户名已存在';
    //             }else if(result==0){
    //                 unameMsg.innerHTML='用户名可以使用';
    //                 isregisterUname=true;
    //             }else if(result==2){
    //                 unameMsg.innerHTML='用户名不能为空';
    //             }
    //         }
    //     }
    //     //打开链接，创建请求
    //     xhr.open('post','/user/register_uname',true);
    //     //发送请求
    //     var formdata='uname='+uname.value;
    //     xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
    //     xhr.send(formdata);
    // }
    function user_add() {
        var xhr = new XMLHttpRequest;
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                var result = xhr.responseText;
                if (result == '1_0') {
                    alert('用户名不能为空');
                } else if (result == '2_0') {
                    alert('密码不能为空');
                } else if (result == '1') {
                    alert('添加成功');
                    location.href = 'http://127.0.0.1:3000/admin_user.html'
                } else {
                    alert('添加失败');
                }
            }
        }
            xhr.open('post','/admin/user_add',true);
            formdata="uname="+uname.value+"&upwd="+upwd.value;
            xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            xhr.send(formdata);
    }
</script>
</body>
</html>